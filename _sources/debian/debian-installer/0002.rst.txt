========================
 Debian-Installer: Udeb
========================



A udeb (or micro-deb) is a special kind of Debian package. Technically udebs are very similar to regular packages: you can look at their contents using **dpkg -c**, and extract them using **dpkg -x and dpkg -e**.

.. code-block:: console

   harrison@debian-build:~/debian-installer/build$ dpkg -c ./apt.udeb/cache/archives/ethdetect_1.159_all.udeb
   drwxr-xr-x root/root         0 2023-05-23 13:22 ./
   drwxr-xr-x root/root         0 2023-05-23 13:22 ./bin/
   -rwxr-xr-x root/root      5258 2023-05-23 13:22 ./bin/ethdetect
   drwxr-xr-x root/root         0 2023-05-23 13:22 ./etc/
   drwxr-xr-x root/root         0 2023-05-23 13:22 ./etc/network/
   -rw-r--r-- root/root      2132 2023-05-23 13:22 ./etc/network/devnames-static.gz
   harrison@debian-build:~/debian-installer/build$ 
   
   
		

The main difference is that a lot of policy requirements are waived. For example, a udeb does not contain a changelog, licence, manpages or md5sums[4]. The reason is to minimize size which is important as the installation takes place completely in RAM, with swap only becoming available after stage 4 of the installation (partitioning).


Another important difference is that udebs are not really meant to be uninstalled or upgraded.

Two special classes of udebs should be mentioned here. However, covering these in detail is outside the scope of this document.

Kernel image and kernel module udebs


* Kernel udebs are built basically by repackaging a regular kernel image package. Reason is again to reduce memory usage: not all modules included in a kernel image package are needed during an installation. Also, different modules are needed in the initrd for different installation methods, remaining modules can either be loaded later or optionally (by manual selection or through dependencies). The package kernel-wedge contains the toolset used to reorganize a kernel-image package into multiple kernel (module) udebs.


.. note::

   The 'u' stands for micro. An udeb is a stripped down deb file for use by the DebianInstaller . It removes the naughty bits (the documentation, as well as some checksums, etc.) to save space. 



**The Debian-installer would use 'sources.list.udeb' to configure apt to download udebs from a mirror**


.. code-block:: console

   harrison@debian-build:~/debian-installer/build$ cat sources.list.udeb 
   # This file is automatically generated, edit sources.list.udeb.local instead.
   deb [trusted=yes] copy:/home/harrison/debian-installer/build/ localudebs/
   deb http://deb.debian.org/debian bookworm main/debian-installer
   deb http://deb.debian.org/debian bookworm-proposed-updates main/debian-installer
   harrison@debian-build:~/debian-installer/build$ 


Apt would download Packages.gz from https://deb.debian.org/debian/dists/bookworm/main/debian-installer/binary-amd64/Packages.gz

This link was configured by "deb http://deb.debian.org/debian bookworm main/debian-installer"

The packages.gz consist of multiple  packages information.

.. code-block:: console

   Package: zlib1g-udeb
   Source: zlib
   Version: 1:1.2.13.dfsg-1
   Installed-Size: 125
   Maintainer: Mark Brown <broonie@debian.org>
   Architecture: amd64
   Description: compression library - runtime for Debian installer
   Description-md5: 9cab974e3eab657c53bc17611b894c7a
   Section: debian-installer
   Priority: optional
   Filename: pool/main/z/zlib/zlib1g-udeb_1.2.13.dfsg-1_amd64.udeb
   Size: 53468
   MD5sum: 6533dfe8750de17c588bb7186a50dbdb
   SHA256: 60c1ccf74a2de41b237300841dc47a5d0bbf3b7faafdd0e0089873ac6db93740
   
   wrsadmin@pek-hliu4-d1:~/workspace/debian$ cat Packages


The zlib1g-udeb could be got from https://deb.debian.org/debian/pool/main/z/zlib/zlib1g-udeb_1.2.13.dfsg-1_amd64.udeb
